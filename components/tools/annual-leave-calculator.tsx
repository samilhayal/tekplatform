"use client"
import{useState,useEffect}from"react";import{Card,CardContent}from"@/components/ui/card";import{Input}from"@/components/ui/input";import{Button}from"@/components/ui/button";import{Calendar,Home,BookOpen,Lightbulb,AlertCircle,Info,Sun,Plus,Minus,Trash2,Clock}from"lucide-react";import Link from"next/link";const AnnualLeaveCalculator=()=>{const[startDay,setStartDay]=useState("");const[startMonth,setStartMonth]=useState("");const[startYear,setStartYear]=useState("");const[result,setResult]=useState<any>(null);const[leaveRecords,setLeaveRecords]=useState<any[]>([]);const[usedDays,setUsedDays]=useState("");const[leaveDate,setLeaveDate]=useState("");useEffect(()=>{const saved=localStorage.getItem('annualLeaveRecords');if(saved)setLeaveRecords(JSON.parse(saved))},[]);const saveRecords=(records:any[])=>{setLeaveRecords(records);localStorage.setItem('annualLeaveRecords',JSON.stringify(records))};const calculate=()=>{const d=parseInt(startDay);const m=parseInt(startMonth);const y=parseInt(startYear);if(isNaN(d)||isNaN(m)||isNaN(y)||d<1||d>31||m<1||m>12||y<1900)return;const startDate=new Date(y,m-1,d);const today=new Date();const diffTime=Math.abs(today.getTime()-startDate.getTime());const totalDays=Math.ceil(diffTime/(1000*60*60*24));const years=totalDays/365;const entitledDays=years<1?0:years<5?14:years<15?20:26;const totalUsed=leaveRecords.reduce((sum,r)=>sum+r.days,0);const remaining=entitledDays-totalUsed;setResult({years:years.toFixed(1),totalDays,entitledDays,totalUsed,remaining:Math.max(0,remaining),usagePercent:entitledDays>0?((totalUsed/entitledDays)*100).toFixed(1):0})};const addLeaveRecord=()=>{const days=parseInt(usedDays);const date=leaveDate;if(isNaN(days)||days<1||!date)return;const newRecord={id:Date.now(),days,date,addedAt:new Date().toLocaleDateString('tr-TR')};saveRecords([...leaveRecords,newRecord]);setUsedDays("");setLeaveDate("");if(result)calculate()};const removeRecord=(id:number)=>{saveRecords(leaveRecords.filter(r=>r.id!==id));if(result)calculate()};return(<div className="w-full max-w-5xl mx-auto space-y-6"><Link href="/"><Button variant="outline"className="mb-4 hover:scale-105 transition-transform"><Home className="w-4 h-4 mr-2"/>Ana Sayfaya Dön</Button></Link><Card className="border-2 border-amber-100/50 shadow-xl"><CardContent className="pt-8 pb-8 px-6 sm:px-8"><div className="mb-8 text-center"><div className="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-amber-500 to-orange-600 shadow-lg mb-4"><Sun className="h-8 w-8 text-white"/></div><h2 className="text-3xl font-bold bg-gradient-to-r from-amber-600 to-orange-600 bg-clip-text text-transparent mb-2">Yıllık İzin Hesaplayıcı</h2><p className="text-slate-600">İzin haklarınızı hesaplayın ve takip edin</p></div><div className="mb-6"><label className="text-sm font-semibold text-slate-700 mb-2 block flex items-center gap-2"><Calendar className="w-4 h-4"/>İşe Başlama Tarihi</label><div className="grid grid-cols-3 gap-3"><Input type="number"value={startDay}onChange={(e)=>setStartDay(e.target.value)}placeholder="Gün"className="h-12"/><Input type="number"value={startMonth}onChange={(e)=>setStartMonth(e.target.value)}placeholder="Ay"className="h-12"/><Input type="number"value={startYear}onChange={(e)=>setStartYear(e.target.value)}placeholder="Yıl"className="h-12"/></div></div><Button onClick={calculate}className="w-full h-14 bg-gradient-to-r from-amber-500 to-orange-600 hover:shadow-lg transition-all"><Calendar className="mr-2"/>İzin Hakkını Hesapla</Button>{result&&(<div className="mt-8 space-y-4 animate-in fade-in slide-in-from-bottom-4"><div className="p-8 rounded-2xl bg-gradient-to-br from-amber-50 to-orange-50 border-2 border-amber-200 text-center"><p className="text-sm font-semibold text-slate-600 mb-2">Yıllık İzin Hakkınız</p><p className="text-6xl font-bold text-amber-600 mb-2">{result.entitledDays}</p><p className="text-2xl font-bold text-orange-600">Gün</p></div><div className="grid grid-cols-2 md:grid-cols-4 gap-4"><div className="p-4 rounded-xl bg-white border-2 border-amber-100 text-center"><p className="text-sm text-slate-600">Çalışma Yılı</p><p className="text-3xl font-bold text-amber-600">{result.years}</p></div><div className="p-4 rounded-xl bg-white border-2 border-orange-100 text-center"><p className="text-sm text-slate-600">Kullanılan</p><p className="text-3xl font-bold text-orange-600">{result.totalUsed}</p></div><div className="p-4 rounded-xl bg-white border-2 border-amber-100 text-center"><p className="text-sm text-slate-600">Kalan</p><p className="text-3xl font-bold text-green-600">{result.remaining}</p></div><div className="p-4 rounded-xl bg-white border-2 border-orange-100 text-center"><p className="text-sm text-slate-600">Kullanım</p><p className="text-3xl font-bold text-amber-600">%{result.usagePercent}</p></div></div><div className="p-6 rounded-xl bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200"><div className="mb-3"><div className="flex items-center justify-between mb-2"><span className="text-sm font-semibold text-slate-700">Kullanılan İzin</span><span className="text-sm font-bold text-orange-600">%{result.usagePercent}</span></div><div className="relative h-4 bg-amber-200 rounded-full overflow-hidden"><div className="absolute top-0 left-0 h-full bg-gradient-to-r from-amber-500 to-orange-600 rounded-full"style={{width:`${result.usagePercent}%`}}/></div></div><div className="mt-3"><div className="flex items-center justify-between mb-2"><span className="text-sm font-semibold text-slate-700">Kalan İzin</span><span className="text-sm font-bold text-green-600">%{(100-parseFloat(result.usagePercent)).toFixed(1)}</span></div><div className="relative h-4 bg-green-200 rounded-full overflow-hidden"><div className="absolute top-0 left-0 h-full bg-gradient-to-r from-green-500 to-emerald-600 rounded-full"style={{width:`${100-parseFloat(result.usagePercent)}%`}}/></div></div></div><div className="mt-6 p-4 rounded-xl bg-white border-2 border-amber-100"><h4 className="font-bold text-slate-800 mb-3 flex items-center gap-2"><Plus className="w-5 h-5 text-amber-600"/>İzin Kaydı Ekle</h4><div className="grid md:grid-cols-2 gap-3 mb-3"><Input type="number"value={usedDays}onChange={(e)=>setUsedDays(e.target.value)}placeholder="Kullanılan gün sayısı"className="h-10"/><Input type="date"value={leaveDate}onChange={(e)=>setLeaveDate(e.target.value)}className="h-10"/></div><Button onClick={addLeaveRecord}className="w-full h-10 bg-gradient-to-r from-amber-500 to-orange-600"size="sm"><Plus className="w-4 h-4 mr-2"/>Kaydet</Button></div>{leaveRecords.length>0&&(<div className="mt-6 p-4 rounded-xl bg-white border-2 border-amber-100"><h4 className="font-bold text-slate-800 mb-3 flex items-center gap-2"><Clock className="w-5 h-5 text-amber-600"/>İzin Geçmişi ({leaveRecords.length} kayıt)</h4><div className="space-y-2 max-h-60 overflow-y-auto">{leaveRecords.map(record=><div key={record.id}className="flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200"><div className="flex items-center gap-3"><Calendar className="w-4 h-4 text-amber-600"/><div><p className="text-sm font-semibold text-slate-800">{record.days} gün</p><p className="text-xs text-slate-600">{new Date(record.date).toLocaleDateString('tr-TR')}</p></div></div><Button variant="ghost"size="sm"onClick={()=>removeRecord(record.id)}className="h-8 w-8 p-0 hover:bg-red-50"><Trash2 className="w-4 h-4 text-red-500"/></Button></div>)}</div></div>)}</div>)}</CardContent></Card><div className="grid md:grid-cols-2 gap-6"><Card className="border-2 border-amber-100/50"><CardContent className="pt-6"><div className="flex items-start gap-3 mb-3"><BookOpen className="w-5 h-5 text-amber-600 mt-1"/><div><h3 className="font-bold text-slate-800 mb-2">Nasıl Kullanılır?</h3><p className="text-sm text-slate-600">İşe başlama tarihini gün/ay/yıl formatında girin. Kullandığınız izin günlerini ekleyin. Sistem otomatik olarak kalan izninizi hesaplar ve kaydeder.</p></div></div></CardContent></Card><Card className="border-2 border-orange-100/50"><CardContent className="pt-6"><div className="flex items-start gap-3 mb-3"><Lightbulb className="w-5 h-5 text-orange-600 mt-1"/><div><h3 className="font-bold text-slate-800 mb-2">Örnek Kullanım</h3><p className="text-sm text-slate-600 mb-2"><strong>Örnek:</strong> 1/1/2018 başlangıç (7 yıl)</p><p className="text-sm text-slate-600">Sonuç: <strong>20 gün</strong> yıllık izin hakkı (5-15 yıl arası)</p></div></div></CardContent></Card><Card className="border-2 border-amber-100/50"><CardContent className="pt-6"><div className="flex items-start gap-3 mb-3"><AlertCircle className="w-5 h-5 text-amber-600 mt-1"/><div><h3 className="font-bold text-slate-800 mb-2">Önemli Bilgiler</h3><p className="text-sm text-slate-600">1 yıldan az: 0 gün, 1-5 yıl: 14 gün, 5-15 yıl: 20 gün, 15+ yıl: 26 gün. İzin kayıtları tarayıcınızda saklanır.</p></div></div></CardContent></Card><Card className="border-2 border-orange-100/50"><CardContent className="pt-6"><div className="flex items-start gap-3 mb-3"><Info className="w-5 h-5 text-orange-600 mt-1"/><div><h3 className="font-bold text-slate-800 mb-2">İlginç Bilgiler</h3><p className="text-sm text-slate-600">Dünya'da en uzun yıllık izin Fransa'da (30 gün). Türkiye Avrupa ortalamasının (22 gün) altındadır.</p></div></div></CardContent></Card></div></div>)};export{AnnualLeaveCalculator};